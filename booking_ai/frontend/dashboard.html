<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Waiter — Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --bg:#0f172a; --card:#111827; --muted:#94a3b8; --ring:#334155; --text:#e5e7eb; }
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,Segoe UI,Roboto}
    .wrap{max-width:960px;margin:24px auto;padding:16px}
    h2{margin:24px 0 12px;font-size:20px}
    .card{background:var(--card);border:1px solid var(--ring);border-radius:14px;padding:16px;margin-bottom:24px}
    form{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    input,button{font:inherit;padding:10px;border-radius:8px;border:1px solid var(--ring)}
    input{flex:1;background:#0b1220;color:var(--text)}
    button{background:#1e293b;color:var(--text);cursor:pointer}
    button:disabled{opacity:.6}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;border-bottom:1px solid var(--ring);text-align:left}
    th{color:var(--muted);font-weight:500}
    .small{font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>AI Waiter — Worker Dashboard</h1>

    <div class="card">
      <h2>Slots</h2>
      <form id="slotForm">
        <input type="text" id="slotTime" placeholder="Enter slot time e.g. 2025-09-19T19:00" required />
        <button type="submit">Add Slot</button>
      </form>
      <table>
        <thead><tr><th>ID</th><th>Time</th></tr></thead>
        <tbody id="slotsBody"></tbody>
      </table>
    </div>

    <div class="card">
      <h2>Bookings</h2>
      <form id="bookingForm">
        <input type="number" id="slotId" placeholder="Slot ID" required />
        <input type="text" id="custName" placeholder="Customer Name" required />
        <input type="email" id="custEmail" placeholder="Customer Email" required />
        <button type="submit">Add Booking</button>
      </form>
      <table>
        <thead><tr><th>ID</th><th>Slot</th><th>Name</th><th>Email</th></tr></thead>
        <tbody id="bookingsBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    const API = "https://ai-waiter-beta.onrender.com"; // your backend

    async function fetchSlots() {
      const res = await fetch(`${API}/slots/`);
      const slots = await res.json();
      const tbody = document.getElementById('slotsBody');
      tbody.innerHTML = '';
      slots.forEach(s => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${s.id}</td><td>${s.time}</td>`;
        tbody.appendChild(tr);
      });
    }

    async function fetchBookings() {
      const res = await fetch(`${API}/bookings/`);
      const bookings = await res.json();
      const tbody = document.getElementById('bookingsBody');
      tbody.innerHTML = '';
      bookings.forEach(b => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${b.id}</td><td>${b.slot_id}</td><td>${b.customer_name}</td><td>${b.customer_email}</td>`;
        tbody.appendChild(tr);
      });
    }

    document.getElementById('slotForm').addEventListener('submit', async e => {
      e.preventDefault();
      const time = document.getElementById('slotTime').value;
      await fetch(`${API}/slots/`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ time })
      });
      e.target.reset();
      fetchSlots();
    });

    document.getElementById('bookingForm').addEventListener('submit', async e => {
      e.preventDefault();
      const slot_id = parseInt(document.getElementById('slotId').value, 10);
      const customer_name = document.getElementById('custName').value;
      const customer_email = document.getElementById('custEmail').value;
      await fetch(`${API}/bookings/`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ slot_id, customer_name, customer_email })
      });
      e.target.reset();
      fetchBookings();
    });

    // load on start
    fetchSlots();
    fetchBookings();
  </script>
</body>
</html>
